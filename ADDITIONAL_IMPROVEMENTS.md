# 営業日報くん 追加改善案

## 分析日時
2025年11月2日

## 現状の到達点
- Phase 2完了: 製品カタログ、農業知識、Few-shot例の実装
- エラーハンドリング強化: リトライ、品質チェック
- プロンプト最適化: 温度0.4、詳細な指示

---

## 追加改善案（優先度順）

### 🔥 優先度A: 即座に実装すべき改善

#### A1. 入力補助機能（テンプレート・ガイド）
**現状の課題**:
- ユーザーが何を入力すべきか分からない
- 情報不足の入力が多い

**改善案**:
```typescript
// 入力ヘルプテキスト
const inputGuide = `
【入力のコツ】
✓ 訪問先名と参加者を明記
✓ 具体的な数値（面積、使用量、金額等）
✓ 顧客の反応や懸念点
✓ 次回の約束や期限

【例】
「○○農園の田中様を訪問。大豆5haで除草に困っているとのこと。
パワーガイザー液剤を提案し、まず1haで試験したいと...」
`;
```

**実装箇所**: UI上の入力フィールド下部にヒント表示

#### A2. フィードバック機能（👍/👎評価）
**現状の課題**:
- 出力の良し悪しが分からない
- 改善のためのデータ収集なし

**改善案**:
```typescript
// フィードバックデータ型
type ReportFeedback = {
  reportId: string;
  rating: 'good' | 'bad';
  comment?: string;
  timestamp: string;
  userId: string;
};

// ログファイルに保存
appendFeedback(feedback);
```

**実装内容**:
- 日報出力後に👍/👎ボタン表示
- 任意でコメント入力可能
- フィードバックをログファイルに保存
- 管理画面で統計表示

#### A3. 履歴機能（LocalStorage）
**現状の課題**:
- 過去の日報を参照できない
- 同じ顧客への訪問が分からない

**改善案**:
```typescript
type ReportHistory = {
  id: string;
  date: string;
  destination: string;
  products: string[];
  report: DailyReport;
};

// LocalStorageに保存（最新20件）
const history = JSON.parse(localStorage.getItem('dailyReportHistory') || '[]');
```

**実装内容**:
- 生成した日報を自動保存
- 履歴一覧表示（モーダルまたはサイドバー）
- 過去の日報を再利用可能
- 訪問先で絞り込み検索

#### A4. コピー機能の改善
**現状の課題**:
- テキスト形式のみ
- 書式が失われる

**改善案**:
```typescript
// Markdown形式でコピー
function getMarkdownReport(report: DailyReport): string {
  return `# ${report.title}

## 訪問先
${report.visitInfo.destination}

## 参加者
${report.visitInfo.participants.map(p => `- ${p}`).join('\n')}

## 商談対象製品
${report.targetProducts.map(p => `- ${p}`).join('\n')}

## 訪問内容要約

### ① 目的
${report.visitSummary.purpose}

### ② 結果
${report.visitSummary.result}

### ③ 提案
${report.visitSummary.proposal}

### ④ 課題
${report.visitSummary.challenges}

### ⑤ 次のステップ
${report.visitSummary.nextSteps}
`;
}
```

**実装内容**:
- プレーンテキスト/Markdown/HTML形式を選択可能
- セクション別コピー機能
- Excelペースト用TSV形式

---

### 🟡 優先度B: できれば実装したい改善

#### B1. リアルタイムプレビュー
**改善案**:
- 入力中に文字数とキーワードを表示
- 必須情報（訪問先、製品名等）の入力状況を可視化
- 品質スコア（入力の詳細度）をリアルタイム表示

#### B2. 音声入力の精度向上
**改善案**:
- 農業用語辞書をWhisperに渡す
- 録音終了後に確認・修正画面を表示
- 固有名詞（人名、地名等）の自動補正

#### B3. テンプレート機能
**改善案**:
```typescript
const templates = {
  新規提案: '【訪問先】\n\n【現状の課題】\n\n【提案内容】\n\n【顧客の反応】\n\n【次のステップ】\n',
  効果確認: '【前回提案内容】\n\n【確認した効果】\n\n【顧客の評価】\n\n【今後の展開】\n',
  クレーム対応: '【発生した問題】\n\n【原因分析】\n\n【対応策】\n\n【顧客の反応】\n\n【再発防止策】\n'
};
```

#### B4. スマート提案機能
**改善案**:
- 過去の履歴から類似訪問を検出
- 「前回は○○を提案しました」と表示
- フォローアップタイミングを提案

---

### 🟢 優先度C: 将来的な改善

#### C1. PDF/Word出力
**改善案**:
- jsPDFでPDF生成
- 企業ロゴ入り日報フォーマット
- 印刷用レイアウト

#### C2. 分析ダッシュボード
**改善案**:
- 訪問頻度グラフ
- 製品別商談状況
- 顧客別進捗管理
- 営業活動の可視化

#### C3. チーム共有機能
**改善案**:
- 日報のエクスポート/インポート
- URLでの共有
- コメント機能

---

## 今回実装する改善（Phase 3）

### 実装1: 入力補助（テンプレート・ガイド）
- ファイル: `app/agents/daily-reporter/page.tsx`
- 所要時間: 15分

### 実装2: フィードバック機能（👍/👎）
- ファイル:
  - `app/agents/daily-reporter/page.tsx`（UI）
  - `lib/types/daily-report.ts`（型追加）
  - `lib/utils/logger.ts`（ログ保存）
- 所要時間: 30分

### 実装3: 履歴機能（LocalStorage）
- ファイル: `app/agents/daily-reporter/page.tsx`
- 所要時間: 30分

### 実装4: コピー機能改善（Markdown形式）
- ファイル: `app/agents/daily-reporter/page.tsx`
- 所要時間: 15分

### 実装5: プロンプト最適化（詳細化）
- ファイル: `app/api/daily-report/route.ts`
- 所要時間: 15分

---

## 合計所要時間: 約1.5時間

---

## 実装後の期待効果

### ユーザー体験の向上
- 入力補助により、質の高い商談内容を入力しやすくなる
- 履歴機能により、過去の日報を参照しながら作成できる
- フィードバック機能により、出力品質を評価できる

### 出力品質の向上
- 入力補助により、必要な情報が揃う
- プロンプト最適化により、さらに詳細な日報を生成
- フィードバックデータを元に継続的な改善が可能

### データ活用の促進
- 履歴データから顧客動向を分析
- フィードバックデータから品質傾向を把握
- 営業活動の見える化

---

## 実装優先順位の理由

1. **入力補助**: 最も効果が高く、実装も簡単
2. **フィードバック**: データ収集が最優先、後の改善に必須
3. **履歴機能**: ユーザー体験向上に直結
4. **コピー改善**: 日報の実用性が向上
5. **プロンプト最適化**: 継続的な品質向上

---

## 次のフェーズ（Phase 4）候補

- PDF/Word出力機能
- 分析ダッシュボード
- 音声入力の精度向上
- テンプレート機能の拡充
- チーム共有機能
